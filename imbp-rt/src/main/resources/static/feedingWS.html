<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Feeding data</title>
</head>
<body>
    <div id="update"></div>
    <table style="width:100%">
        <tr>
            <th style="width:25%; text-align: left">image</th>
            <th style="width:25%; text-align: left">name</th>
            <th style="width:25%; text-align: left">name</th>
            <th style="width:25%; text-align: left">name</th>
        </tr>

        <tr>
            <td id="image1"></td>
            <td id="image2"></td>
            <td id="image3"></td>
            <td id="image4"></td>
        </tr>
    </table>
<script>
    window.addEventListener('load', function (ev) {
        var image1 = document.getElementById('image1');
        var image2 = document.getElementById('image2');
        var image3 = document.getElementById('image3');
        var image4 = document.getElementById('image4');
        window.onbeforeunload = function() {
            websocket.onclose = function () {}; // disable onclose handler first
            websocket.close();
        };
        // var date = window.prompt('date');
        // var dateArray = date.split('/');
        var ws = new WebSocket('ws://localhost:8085/ws/api/rt/feeding');

        ws.onopen = function() {

            for(var i=0; i<10; i++) {
                ws.send(i);
            }
        };

        ws.onmessage = function (evt) {
            image1.innerHTML = evt.data;
            image2.innerHTML = evt.data;
            image3.innerHTML = evt.data;
            image4.innerHTML = evt.data;
        };

        //     image3.innerHTML = '<img width="50"   src="data:image/jpg;base64,"'+ + evt.data + '>'

        ws.onclose = function() {
            alert("DONE");

        };

        ws.onerror = function (ev1) {
            alert(ev1.data);
        }
    })
    function sleep(delay) {
        var start = new Date().getTime();
        while (new Date().getTime() < start + delay);
    }
</script>
</body>
</html>